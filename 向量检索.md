## 创建索引正确请求

PUT http://localhost:9200/doc_vector
Content-Type: application/json

```json
{
  "mappings": {
    "properties":{
      "title":{
        "type": "text",
        "analyzer": "ik_max_word"
      },
      "embedding_vector": {
        "type": "binary",
        "doc_values": true
      }
    }
  }
}
```

POST http://localhost:9200/doc_vector/_doc/1
Content-Type: application/json

{
"title": "过滤",
"embedding_vector": "vh/hiD2T6wm8PXs6PhTgeL1gS2W96NIDPmjUUz4LplW9BDwKPHm5/by0+Mu5Tm/puychgrvkIEW7JqBpvC5qir1eYAY9upPJPUn1zL1uvWW8gHHkvIzV3jyRGZW8jE1GPQG4yDxNvq47KEpuOts2X7ulkWg8mVOJvGXC3TseRJE8eLt/vKowOLyQY5E7vfiLO9cTHr2P4Du8iSY+vI8hNz3Gd4Y7IjmaPTB0w7tEZzy9nMlPPD1a072AT7G9Ii56O9RvBjnqrJa8CxPuuozPhjycCf27Wt/qvRLt2Dv3FC48oRbePHSWQTzIzG28LDB4vDDU572zxQA9FmxAvJ5Ndj0o2Uk82N98u580azwPkY+7nPybvOLvTzxF++08s0fbPNl58Lzd1Vw7iiSnO/NJJL0OIJ87Kz3CPirFZj3aruA+G1scvgmQ1b3f6AY9japZvKv3abyI3hc7fmp4Ox54Yj2FvIk8xafVvSZoPryYGJW+iU8FPaI2Oz2Lme+8t69QPcRkMD3B2xq+PzuavZ7/JQ=="
}

POST http://localhost:9200/doc_vector/_doc/1
Content-Type: application/json

{
"title": "带过滤",
"embedding_vector":"PCo3o7sFhxq7qSp/vHDeETtt4wo7bBEdu+WozbwkKvi6+JsRvGGpkDq/6Fk74HbTvMj21TwNeKa6q9MlO+l6djr8FpC7/O+Xu5L01DwYKZo8HOd3u5mucLwhR3w78S5TvF8vBbs2smY7wAkmPCcCf7szcp28EzCWPJHS8jsloXA8QuMvPIuKPbwgr7K8BNVNOxiXPTxrutc8jXXGu1zhhrwqTJm78zQ6OvXpzLuP3i48HYMEuwFxuTxuY5s7vkM3PM5Rczt/zwo7sc6fu68a3DspA8e7/325vMMEOTviS2w7okQTvCgrN7t18UY7Px9dO7PRiTyFmXu8h1T3O7nhFrsX39e7AFQMO8FeUruV9zi8elgMvEya1jyCjNA8KACHuv5aM7xgeYi7WZXKPDcoBLviXse7SkCCPLNGfjxMyiU8lKA+vHuLibygous7/QJPul0QGTuU9HE7zknyO+Bk4zsy8X26n1g4vCVWWTrkoYc8YDtnO7EVBzqBPMo8Qrq3vJVoGrtTHDU8gMQvOwvdFA=="
}



GET http://localhost:9200/doc_vector/_search
Content-Type: application/json

{
"query": {
"function_score": {
"boost_mode": "replace",
"script_score": {
"script": {
"source": "binary_vector_score",
"lang": "knn",
"params": {
"cosine": false,
"field": "embedding_vector",
"vector": [
-0.15613377,0.07222564,-0.011565024,0.14538753,-0.0547594,-0.113681816,0.22737245,0.1363767,-0.03228382,0.015242097,-0.02209129,-1.968738E-4,-0.002550215,-0.0069618546,-0.0025425202,-0.010645518,-0.054290794,0.09110219,0.049306676,-0.05828609,-0.015679307,-0.017191824,0.017712394,-0.01712669,0.03167036,0.012557669,0.002567913,0.0016724578,-0.005052734,0.01871659,-0.01402351,0.0024149755,0.015181421,-0.020774946,-0.017625602,0.005797451,0.0065635582,-0.070251904,-0.016741868,-0.017471893,0.09690766,0.0024753571,0.043080103,-0.002996876,-0.07655584,0.011557299,-0.062652,-0.039595105,0.0064829616,4.4760545E-4,-0.008488638,-0.0010742999,0.019047732,-0.0033397623,-0.035871357,0.0075402474,0.019664224,0.014928401,0.02451154,-0.010509603,-0.010792947,-0.08777809,0.03672433,-0.019324046,0.041222844,0.026473753,-0.0048585436,0.008762731,-0.004790855,-0.027702002,0.01208399,0.02188485,0.026547402,-0.027079277,0.004215795,0.0074244905,-0.03469908,0.002612934,0.16676864,0.10677886,0.15171474,-0.13434155,-0.10932927,0.06917257,-0.020991998,-0.016707463,0.0038820785,0.002418064,0.06530101,0.02412788,-0.040626757,-0.01856641,-0.268181,0.079205,0.0681647,-0.022422463,0.09589422,0.094656184,-0.1867508,-0.07763509
]
}
}
}
}
},
"size": 100
}
